jQuery(document).ready(function(a){function q(c,e){var d={onChange:null},b={contain:null,pageLeft:null,pageRight:null,currentPage:null},h=function(){var a=b.currentPage.children().length,f=Number(b.currentPage.val());b.pageLeft.hide();b.pageRight.hide();1<f&&b.pageLeft.show();f+1<=a&&b.pageRight.show()};this.getCurrentPage=function(){return b.currentPage.val()};this.setNumPage=function(c){b.currentPage.empty();for(var f=1;f<=c;f++)a(document.createElement("option")).val(f).text(f).appendTo(b.currentPage);
h()};(function(){a.extend(b,{contain:c,pageLeft:c.find(".navigationLeft"),pageRight:c.find(".navigationRight"),currentPage:c.find(".navigationCurrentPage")});a.extend(d,e);b.pageLeft.click(function(){b.currentPage.val(Number(b.currentPage.val())-1);h();if(d.onChange)d.onChange(b.currentPage.val())});b.pageRight.click(function(){b.currentPage.val(Number(b.currentPage.val())+1);h();if(d.onChange)d.onChange(b.currentPage.val())});b.currentPage.change(function(){h();if(d.onChange)d.onChange(b.currentPage.val())})})()}
a.fn.wpProQuiz_preview=function(){var c={openPreview:function(c){window.open(a(c).attr("href"),"wpProQuizPreview","width=900,height=900")}};(function(){a(".wpProQuiz_prview").click(function(a){c.openPreview(this);a.preventDefault()})})()};a.fn.wpProQuiz_quizOverall=function(){function c(b){b=a.trim(b);return!b||0===b.length}function e(b,c,d){a.post(ajaxurl,{action:"wp_pro_quiz_admin_ajax",func:b,data:c},d,"json")}var d={changeExport:function(b){$input=a(b);$export=a(".wpProQuiz_exportList");$export2=
a(".wpProQuiz_setQuizCategoryList");$ul=$export.find("ul").first();$ul2=$export2.find("ul").first();$export.find("li").remove();$export2.find("li").remove();a('input[name="exportItems"]').each(function(){$this=a(this);if(this.checked){var b=$this.parent().parent().find(".wpProQuiz_quizName a:eq(0)").text();a("<li>"+b+"</li>").appendTo($ul);a("<li>"+b+"</li>").appendTo($ul2)}})},startExport:function(){$ele=a('input[name="exportItems"]:checked');if(1>$ele.length)return alert(wpProQuizLocalize.no_selected_quiz),
!1;$hidden=a("#exportHidden");$hidden.html("");a('input[name="exportItems"]').each(function(){$this=a(this);this.checked&&a('<input type="hidden" value="'+this.value+'" name="exportIds[]">').appendTo($hidden)});return!0},setCategoriesStart:function(){$ele=a('input[name="exportItems"]:checked');if(1>$ele.length)return alert(wpProQuizLocalize.no_selected_quiz),!1;var b=[];a('input[name="exportItems"]').each(function(){$this=a(this);this.checked&&b.push(this.value)});var c={categoryId:a('select[name="category"]').val(),
quizIds:b};a("#ajaxLoad").show();e("setQuizMultipleCategories",c,function(a){location.reload()});return!0},addCategory:function(){var b=a.trim(a('input[name="categoryAdd"]').val());c(b)||e("categoryAdd",{categoryName:b,type:"quiz"},function(b){b.err?a("#categoryMsgBox").text(b.err).show("fast").delay(2E3).hide("fast"):(b=a(document.createElement("option")).val(b.categoryId).text(b.categoryName).attr("selected","selected"),a('select[name="category"]').append(b).change())})}};(function(){a(".wpProQuiz_delete").click(function(a){return confirm(wpProQuizLocalize.delete_msg)?
!0:(a.preventDefault(),!1)});a(".wpProQuiz_import").click(function(b){b.preventDefault();a(".wpProQuiz_importList").show("fast");a(".wpProQuiz_exportList, .wpProQuiz_setQuizCategoryList").hide();a(".wpProQuiz_exportCheck").hide()});a(".wpProQuiz_export").click(function(b){b.preventDefault();a(".wpProQuiz_exportList").show("fast");a(".wpProQuiz_exportCheck").show("fast");a(".wpProQuiz_importList, .wpProQuiz_setQuizCategoryList").hide()});a(".wpProQuiz_setQuizCategory").click(function(b){b.preventDefault();
a(".wpProQuiz_setQuizCategoryList").show("fast");a(".wpProQuiz_exportCheck").show("fast");a(".wpProQuiz_importList, .wpProQuiz_exportList").hide()});a('input[name="exportItems"]').change(function(){d.changeExport(this)});a('input[name="exportItemsAll"]').change(function(){var b=a('input[name="exportItems"]');this.checked?b.attr("checked",!0):b.attr("checked",!1);b.change()});a("#exportStart").click(function(a){d.startExport()||a.preventDefault()});a("#setCategoriesStart").click(function(a){d.setCategoriesStart()||
a.preventDefault()});a('select[name="category"]').change(function(){var b=a(this),c=a("#categoryAddBox").hide();"-1"==b.val()&&c.show()}).change();a("#categoryAddBtn").click(function(){d.addCategory()})})()};a.fn.wpProQuiz_questionOverall=function(){var c={saveSort:function(){var e={action:"wp_pro_quiz_update_sort",sort:c.parseSortArray()},d=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=save_sort";a.post(d,e,function(b){a("#sortMsg").show(400).delay(1E3).hide(400)})},
parseSortArray:function(){var c=[];a("tbody tr").each(function(){c.push(this.id.replace("wpProQuiz_questionId_",""))});return c},sortUpdate:function(c,d){a(".wpProQuiz_questionOverall tbody").children().each(function(){$t=a(this).children().first().text(a(this).index()+1)})},loadQuestionCopy:function(){var c=a("#questionCopySelect"),d=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=load_question";c.hide();c.empty();a("#loadDataImg").show();a.post(d,
{action:"wp_pro_quiz_load_question",excludeId:1},function(b){a.each(b,function(b,d){var f=a(document.createElement("optgroup"));f.attr("label",d.name);a.each(d.question,function(b,c){a(document.createElement("option")).val(c.id).text(c.name).appendTo(f)});c.append(f)});a("#loadDataImg").hide();c.show()},"json")}};(function(){a(".wp-list-table tbody").sortable({handle:".wpProQuiz_move",update:c.sortUpdate});a(".wpProQuiz_delete").click(function(a){return confirm(wpProQuizLocalize.delete_msg)?!0:(a.preventDefault(),
!1)});a("#wpProQuiz_saveSort").click(function(a){a.preventDefault();c.saveSort()});a("#wpProQuiz_questionCopy").click(function(e){var d=a(".wpProQuiz_questionCopy");d.is(":visible")?d.hide():(d.show(),c.loadQuestionCopy());e.preventDefault()})})()};a.fn.wpProQuiz_quizEdit=function(){function c(b,c,d){a.post(ajaxurl,{action:"wp_pro_quiz_admin_ajax",func:b,data:c},d,"json")}var e={addCategory:function(){var b=a.trim(a('input[name="categoryAdd"]').val());d(b)||c("categoryAdd",{categoryName:b,type:"quiz"},
function(b){b.err?a("#categoryMsgBox").text(b.err).show("fast").delay(2E3).hide("fast"):(b=a(document.createElement("option")).val(b.categoryId).text(b.categoryName).attr("selected","selected"),a('select[name="category"]').append(b).change())})},addResult:function(){a("#resultList").children().each(function(){if("none"==a(this).css("display")){var b=a(this),c=b.find('textarea[name="resultTextGrade[text][]"]'),d=c.attr("id"),f=!0;b.find('input[name="resultTextGrade[prozent][]"]').val("0");b.find('input[name="resultTextGrade[activ][]"]').val("1").keyup();
void 0==tinymce.editors[d]||tinymce.editors[d].isHidden()||(f=!1);void 0==switchEditors||f||(switchEditors.go(d,"toggle"),switchEditors.go(d,"toggle"));void 0!=tinymce.editors[d]?tinymce.editors[d].setContent(""):c.val("");void 0==tinymce.editors[d]||f||tinyMCE.execCommand("mceRemoveControl",!1,d);b.parent().children(":visible").last().after(b);void 0==tinymce.editors[d]||f||tinyMCE.execCommand("mceAddControl",!1,d);a(this).show();void 0==switchEditors||f||switchEditors.go(d,"toggle");return!1}})},
deleteResult:function(b){a(b).parent().parent().hide();a(b).siblings('input[name="resultTextGrade[activ][]"]').val("0")},changeResult:function(b){b=a(b);if(e.validResultInput(b.val()))return b.siblings(".resultProzent").text(b.val()),b.removeAttr("style"),!0;b.css("background-color","#FF9696");return!1},validResultInput:function(a){if(d(a))return!1;a=a.replace(/\,/,".");return!isNaN(a)&&100>=Number(a)&&0<=Number(a)?null!=a.match(/\./)?3>a.split(".")[1].length:!0:!1},validInput:function(){if(d(a("#wpProQuiz_title").val()))return alert(wpProQuizLocalize.no_title_msg),
!1;var b="",b=void 0==tinymce.editors.text||tinymce.editors.text.isHidden()?a('textarea[name="text"]').val():tinymce.editors.text.getContent();if(d(b))return alert(wpProQuizLocalize.no_quiz_start_msg),!1;if(a("#wpProQuiz_resultGradeEnabled:checked").length){var c=!0;a("#resultList").children().each(function(){if(a(this).is(":visible")&&!e.validResultInput(a(this).find('input[name="resultTextGrade[prozent][]"]').val()))return c=!1});if(!c)return alert(wpProQuizLocalize.fail_grade_result),!1}return!0},
resetLock:function(){var b=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php"),b=b.replace("action=edit","action=reset_lock");a.post(b,{action:"wp_pro_quiz_reset_lock"},function(b){a("#resetLockMsg").show("fast").delay(2E3).hide("fast")})},generateFormIds:function(){var b=0;a("#form_table tbody > tr").each(function(){a(this).find('[name^="form[]"]').each(function(){var c=a(this).attr("name").substr(6);a(this).attr("name","form["+b+"]"+c)});++b})},updateFormIds:function(){var b=
-1,c=a(".emailFormVariables option:selected").val(),e=a(".formVariables").empty(),f=a(".emailFormVariables").empty().append('<option value="-1"></option>');-1<a(".emailFormVariables").data("default")&&(c=a(".emailFormVariables").data("default"),a(".emailFormVariables").data("default",-1));a("#form_table tbody > tr").each(function(){a(this).children().first().text(b);var c=a(this).find(".formFieldName").val(),l=a(this).find('[name="form[][type]"] option:selected'),g=a(this).find('[name="form[][fieldname]"]').val();
1!=a(this).find('input[name="form[][form_delete]"]').val()&&(0<=b&&!d(c)&&e.append(a("<li><span>$form{"+b+"}</span> - "+c+"</li>")),4==l.val()&&f.append(a('<option value="'+b+'">'+g+"</option>")),b++)});a('.emailFormVariables option[value="'+c+'"]').prop("selected",!0)}},d=function(b){b=a.trim(b);return!b||0===b.length};(function(){a("#statistics_on").change(function(){this.checked?a("#statistics_ip_lock_tr").show():a("#statistics_ip_lock_tr").hide()});a(".addResult").click(function(){e.addResult()});
a(".deleteResult").click(function(a){e.deleteResult(this)});a('input[name="resultTextGrade[prozent][]"]').keyup(function(a){e.changeResult(this)}).keydown(function(a){13==a.which&&a.preventDefault()});a("#wpProQuiz_resultGradeEnabled").change(function(){this.checked?(a("#resultGrade").show(),a("#resultNormal").hide()):(a("#resultGrade").hide(),a("#resultNormal").show())});a("#wpProQuiz_save").click(function(b){e.validInput()?e.generateFormIds():b.preventDefault();a('select[name="prerequisiteList[]"] option').attr("selected",
"selected")});a('input[name="template"]').click(function(b){if("0"==a('select[name="templateSaveList"]').val()&&d(a('input[name="templateName"]').val()))return alert(wpProQuizLocalize.temploate_no_name),b.preventDefault(),!1;e.generateFormIds();a('select[name="prerequisiteList[]"] option').attr("selected","selected")});a('select[name="templateSaveList"]').change(function(){var b=a('input[name="templateName"]');"0"==a(this).val()?b.show():b.hide()}).change();a('input[name="quizRunOnce"]').change(function(b){this.checked?
(a("#wpProQuiz_quiz_run_once_type").show(),a('input[name="quizRunOnceType"]:checked').change()):a("#wpProQuiz_quiz_run_once_type").hide()});a('input[name="quizRunOnceType"]').change(function(b){!this.checked||"1"!=this.value&&"3"!=this.value?a("#wpProQuiz_quiz_run_once_cookie").hide():a("#wpProQuiz_quiz_run_once_cookie").show()});a('input[name="resetQuizLock"]').click(function(a){e.resetLock();return!1});a(".wpProQuiz_demoBox a").mouseover(function(b){var c=a(this),d=a(document).width(),c=c.siblings().outerWidth(!0);
b.pageX+c>d&&(b=d-(b.pageX+c+30),a(this).next().css("left",b+"px"));a(this).next().show()}).mouseout(function(){a(this).next().hide()}).click(function(){return!1});a('input[name="showMaxQuestion"]').change(function(){this.checked?a("#wpProQuiz_showMaxBox").show():a("#wpProQuiz_showMaxBox").hide()});a("#btnPrerequisiteAdd").click(function(){a('select[name="quizList"] option:selected').removeAttr("selected").appendTo('select[name="prerequisiteList[]"]')});a("#btnPrerequisiteDelete").click(function(){a('select[name="prerequisiteList[]"] option:selected').removeAttr("selected").appendTo('select[name="quizList"]')});
a('input[name="prerequisite"]').change(function(){this.checked?a("#prerequisiteBox").show():a("#prerequisiteBox").hide()}).change();a('input[name="toplistDataAddMultiple"]').change(function(){this.checked?a("#toplistDataAddBlockBox").show():a("#toplistDataAddBlockBox").hide()}).change();a('input[name="toplistActivated"]').change(function(){this.checked?a("#toplistBox > tr:gt(0)").show():a("#toplistBox > tr:gt(0)").hide()}).change();a('input[name="showReviewQuestion"]').change(function(){this.checked?
a(".wpProQuiz_reviewQuestionOptions").show():a(".wpProQuiz_reviewQuestionOptions").hide()}).change();a("#statistics_on").change();a("#wpProQuiz_resultGradeEnabled").change();a('input[name="quizRunOnce"]').change();a('input[name="quizRunOnceType"]:checked').change();a('input[name="showMaxQuestion"]').change();a("#form_add").click(function(){a("#form_table tbody > tr:eq(0)").clone(!0).appendTo("#form_table tbody").show();e.updateFormIds()});a('input[name="form_delete"]').click(function(){var b=a(this).parents("tr");
"0"!=b.find('input[name="form[][form_id]"]').val()?(b.find('input[name="form[][form_delete]"]').val(1),b.hide()):b.remove();e.updateFormIds()});a("#form_table tbody").sortable({handle:".form_move",update:e.updateFormIds});a(".form_move").click(function(){return!1});a('select[name="form[][type]"]').change(function(){switch(Number(a(this).val())){case 7:case 8:a(this).siblings(".editDropDown").show();break;default:a(this).siblings(".editDropDown, .dropDownEditBox").hide()}}).change();a(".editDropDown").click(function(){a(".dropDownEditBox").not(a(this).siblings(".dropDownEditBox").toggle()).hide();
return!1});a(".dropDownEditBox input").click(function(){a(this).parent().hide()});a('.formFieldName, select[name="form[][type]"]').change(function(){e.updateFormIds()});a('select[name="category"]').change(function(){var b=a(this),c=a("#categoryAddBox").hide();"-1"==b.val()&&c.show()}).change();a("#categoryAddBtn").click(function(){e.addCategory()});a('input[name="emailNotification"]').change(function(){var b=a("#adminEmailSettings tr:gt(0)");0<a('input[name="emailNotification"]:checked').val()?b.show():
b.hide()}).change();a('input[name="userEmailNotification"]').change(function(){var b=a("#userEmailSettings tr:gt(0)");0<a('input[name="userEmailNotification"]:checked').val()?b.show():b.hide()}).change();e.updateFormIds();a('input[name="email[html]"]').change(function(){if(void 0==switchEditors)return!1;this.checked?switchEditors.go("adminEmailEditor","tmce"):switchEditors.go("adminEmailEditor","html")}).change();a('input[name="userEmail[html]"]').change(function(){if(void 0==switchEditors)return!1;
this.checked?switchEditors.go("userEmailEditor","tmce"):switchEditors.go("userEmailEditor","html")}).change()})()};a.fn.wpProQuiz_statistics=function(){var c="wpProQuiz_typeAnonymeUser",e=!0,d={loadStatistics:function(b){var c=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=load_statistics";b={action:"wp_pro_quiz_load_statistics",userId:b};a("#wpProQuiz_loadData").show();a("#wpProQuiz_statistics_content, #wpProQuiz_statistics_overview").hide();a.post(c,
b,d.setStatistics,"json")},setStatistics:function(b){var d=a(".wpProQuiz_statistics_table"),e=d.find("tbody");if("wpProQuiz_typeOverview"!=c){var f=function(a,b,f){a.find(".wpProQuiz_cCorrect").text(b.cCorrect+" ("+b.pCorrect+"%)");a.find(".wpProQuiz_cIncorrect").text(b.cIncorrect+" ("+b.pIncorrect+"%)");a.find(".wpProQuiz_cTip").text(b.cTip);a.find(".wpProQuiz_cPoints").text(b.cPoints);1==f&&d.find(".wpProQuiz_cResult").text(b.result+"%")};f(d,b.clear,!1);a.each(b.items,function(a,b){f(e.find("#wpProQuiz_tr_"+
b.id),b,!1)});f(d.find("tfoot"),b.global,!0);a("#wpProQuiz_loadData").hide();a("#wpProQuiz_statistics_content, .wpProQuiz_statistics_table").show()}},loadOverview:function(){a(".wpProQuiz_statistics_table, #wpProQuiz_statistics_content, #wpProQuiz_statistics_overview").hide();a("#wpProQuiz_loadData").show();var b=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=load_statistics",h={action:"wp_pro_quiz_load_statistics",overview:!0,pageLimit:a("#wpProQuiz_pageLimit").val(),
onlyCompleted:Number(a("#wpProQuiz_onlyCompleted").is(":checked")),page:a("#wpProQuiz_currentPage").val(),generatePageNav:Number(e)};a.post(b,h,function(b){a("#wpProQuiz_statistics_overview_data").empty();if("wpProQuiz_typeOverview"==c){var f=a('<tr><th><a href="#">---</a></th><th class="wpProQuiz_points">---</th><th class="wpProQuiz_cCorrect" style="color: green;">---</th><th class="wpProQuiz_cIncorrect" style="color: red;">---</th><th class="wpProQuiz_cTip">---</th><th class="wpProQuiz_cResult" style="font-weight: bold;">---</th></tr>');
a.each(b.items,function(b,c){var d=f.clone();d.find("a").text(c.userName).data("userId",c.userId).click(function(){a("#userSelect").val(a(this).data("userId"));a("#wpProQuiz_typeRegisteredUser").click();return!1});c.completed?(d.find(".wpProQuiz_points").text(c.cPoints),d.find(".wpProQuiz_cCorrect").text(c.cCorrect+" ("+c.pCorrect+"%)"),d.find(".wpProQuiz_cIncorrect").text(c.cIncorrect+" ("+c.pIncorrect+"%)"),d.find(".wpProQuiz_cTip").text(c.cTip),d.find(".wpProQuiz_cResult").text(c.result+"%")):
d.find("th").removeAttr("style");a("#wpProQuiz_statistics_overview_data").append(d)});void 0!=b.page&&(d.setPageNav(b.page),e=!1);a("#wpProQuiz_loadData").hide();a("#wpProQuiz_statistics_overview").show()}},"json")},loadFormOverview:function(){a("#wpProQuiz_tabFormOverview").show()},changeTab:function(b){c=b;"wpProQuiz_typeRegisteredUser"==b?d.loadStatistics(a("#userSelect").val()):"wpProQuiz_typeAnonymeUser"==b?d.loadStatistics(0):"wpProQuiz_typeForm"==b?d.loadFormOverview():d.loadOverview()},resetStatistic:function(b){var e=
"wpProQuiz_typeRegisteredUser"==c?a("#userSelect").val():0,n=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=reset";a.post(n,{action:"wp_pro_quiz_statistics",userId:e,complete:b},function(a){d.changeTab(c)})},setPageNav:function(b){b=Math.ceil(b/a("#wpProQuiz_pageLimit").val());a("#wpProQuiz_currentPage").empty();for(var c=1;c<=b;c++)a(document.createElement("option")).val(c).text(c).appendTo(a("#wpProQuiz_currentPage"));a("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").hide();
1<a("#wpProQuiz_currentPage option").length&&a("#wpProQuiz_pageRight").show()}};(function(){a(".wpProQuiz_tab").click(function(b){b=a(this);if(b.hasClass("button-primary"))return!1;"wpProQuiz_typeRegisteredUser"==b.attr("id")?a("#wpProQuiz_userBox").show():a("#wpProQuiz_userBox").hide();a(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary");b.removeClass("button-secondary").addClass("button-primary");d.changeTab(b.attr("id"));return!1});a("#userSelect").change(function(){d.changeTab("wpProQuiz_typeRegisteredUser")});
a(".wpProQuiz_update").click(function(){d.changeTab(c);return!1});a("#wpProQuiz_reset").click(function(){confirm(wpProQuizLocalize.reset_statistics_msg)&&d.resetStatistic(!1);return!1});a(".wpProQuiz_resetComplete").click(function(){confirm(wpProQuizLocalize.reset_statistics_msg)&&d.resetStatistic(!0);return!1});a("#wpProQuiz_pageLimit, #wpProQuiz_onlyCompleted").change(function(){a("#wpProQuiz_currentPage").val(0);e=!0;d.changeTab(c);return!1});a("#wpProQuiz_currentPage").change(function(){a("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").hide();
1!=a("#wpProQuiz_currentPage option").length&&(a("#wpProQuiz_currentPage option:first-child:selected").length?a("#wpProQuiz_pageRight").show():a("#wpProQuiz_currentPage option:last-child:selected").length?a("#wpProQuiz_pageLeft").show():a("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").show());d.changeTab(c)});a("#wpProQuiz_pageRight").click(function(){a("#wpProQuiz_currentPage option:selected").next().attr("selected","selected");a("#wpProQuiz_currentPage").change();return!1});a("#wpProQuiz_pageLeft").click(function(){a("#wpProQuiz_currentPage option:selected").prev().attr("selected",
"selected");a("#wpProQuiz_currentPage").change();return!1});d.changeTab("wpProQuiz_typeAnonymeUser")})()};a.fn.wpProQuiz_toplist=function(){var c=a("#wpProQuiz_sorting"),e=a("#wpProQuiz_pageLimit"),d=a("#wpProQuiz_currentPage"),b=a("#wpProQuiz_loadData"),h=a("#wpProQuiz_pageLeft"),n=a("#wpProQuiz_pageRight"),f=a("#wpProQuiz_toplistTable tbody"),p=a("#wpProQuiz_toplistTable tbody tr:eq(0)").clone(),l=a("#wpProQuiz_content"),g={loadData:function(f){var p=(window.location.pathname+window.location.search).replace("admin.php",
"admin-ajax.php")+"&action=load_toplist",k=this,s={action:"wp_pro_quiz_load_toplist",sort:c.val(),limit:e.val(),page:d.val()};void 0!=f&&a.extend(s,f);b.show();l.hide();a.post(p,s,function(a){k.handleDataRequest(a.data);void 0!=a.nav&&k.handleNav(a.nav);b.hide();l.show()},"json")},handleNav:function(b){d.empty();for(var f=1;f<=b.pages;f++)a(document.createElement("option")).val(f).text(f).appendTo(d);this.checkNav()},handleDataRequest:function(b){var c=this;f.empty();a.each(b,function(a,b){var c=
p.clone().children();c.eq(0).children().val(b.id);c.eq(1).find("strong").text(b.name);c.eq(1).find(".inline_editUsername").val(b.name);c.eq(2).find(".wpProQuiz_email").text(b.email);c.eq(2).find("input").val(b.email);c.eq(3).text(b.type);c.eq(4).text(b.date);c.eq(5).text(b.points);c.eq(6).text(b.result);c.parent().show().appendTo(f)});b.length||a(document.createElement("td")).attr("colspan","7").text(wpProQuizLocalize.no_data_available).css({"font-weight":"bold","text-align":"center",padding:"5px"}).appendTo(document.createElement("tr")).appendTo(f);
a(".wpProQuiz_delete").click(function(){if(confirm(wpProQuizLocalize.confirm_delete_entry)){var b=Array(a(this).closest("tr").find('input[name="checkedData[]"]').val());c.loadData({a:"delete",toplistIds:b})}return!1});a(".wpProQuiz_edit").click(function(){var b=a(this).closest("tr");b.find(".row-actions").hide();b.find(".inline-edit").show();b.find(".wpProQuiz_username, .wpProQuiz_email").hide();b.find(".inline_editUsername, .inline_editEmail").show();return!1});a(".inline_editSave").click(function(){var b=
a(this).closest("tr"),f=b.find(".inline_editUsername").val(),d=b.find(".inline_editEmail").val();if(c.isEmpty(f)||c.isEmpty(d))return alert(wpProQuizLocalize.not_all_fields_completed),!1;c.loadData({a:"edit",toplistId:b.find('input[name="checkedData[]"]').val(),name:f,email:d});return!1});a(".inline_editCancel").click(function(){var b=a(this).closest("tr");b.find(".row-actions").show();b.find(".inline-edit").hide();b.find(".wpProQuiz_username, .wpProQuiz_email").show();b.find(".inline_editUsername, .inline_editEmail").hide();
b.find(".inline_editUsername").val(b.find(".wpProQuiz_username").text());b.find(".inline_editEmail").val(b.find(".wpProQuiz_email").text());return!1})},checkNav:function(){var a=d.val();1==a?h.hide():h.show();a==d.children().length?n.hide():n.show()},isEmpty:function(b){b=a.trim(b);return!b||0===b.length}};(function(){c.change(function(){g.loadData()});e.change(function(){g.loadData({nav:1})});d.change(function(){g.checkNav();g.loadData()});h.click(function(){d.val(Number(d.val())-1);g.checkNav();
g.loadData()});n.click(function(){d.val(Number(d.val())+1);g.checkNav();g.loadData()});a("#wpProQuiz_deleteAll").click(function(){g.loadData({a:"deleteAll"})});a("#wpProQuiz_action").click(function(){var b=a("#wpProQuiz_actionName").val();if("0"!=b){var c=a('input[name="checkedData[]"]:checked').map(function(){return a(this).val()}).get();g.loadData({a:b,toplistIds:c})}});a("#wpProQuiz_checkedAll").change(function(){this.checked?a('input[name="checkedData[]"]').attr("checked","checked"):a('input[name="checkedData[]"]').removeAttr("checked",
"checked")});g.loadData({nav:1})})()};a(".wpProQuiz_quizOverall").length&&a(".wpProQuiz_quizOverall").wpProQuiz_preview();a(".wpProQuiz_quizOverall").length&&a(".wpProQuiz_quizOverall").wpProQuiz_quizOverall();a(".wpProQuiz_quizEdit").length&&a(".wpProQuiz_quizEdit").wpProQuiz_quizEdit();a(".wpProQuiz_questionOverall").length&&a(".wpProQuiz_questionOverall").wpProQuiz_questionOverall();a(".wpProQuiz_toplist").length&&a(".wpProQuiz_toplist").wpProQuiz_toplist();(function(){var c=this,c={displayChecked:function(a,
b,c,d){a=c?!a.checked:a.checked;d?a?b.attr("disabled","disabled"):b.removeAttr("disabled"):a?b.show():b.hide()},isEmpty:function(b){b=a.trim(b);return!b||0===b.length},isNumber:function(b){b=a.trim(b);return!c.isEmpty(b)&&!isNaN(b)},getMceContent:function(b){var c=tinymce.editors[b];return void 0==c||c.isHidden()?a("#"+b).val():c.getContent()},ajaxPost:function(b,c,d){a.post(ajaxurl,{action:"wp_pro_quiz_admin_ajax",func:b,data:c},d,"json")}},e=function(){a(".wpProQuiz_tab_wrapper a").click(function(){var b=
a(this),c=b.data("tab"),d=b.siblings(".button-primary").removeClass("button-primary").addClass("button-secondary");b.removeClass("button-secondary").addClass("button-primary");a(d.data("tab")).hide("fast");a(c).show("fast");a(document).trigger({type:"changeTab",tabId:c});return!1})},d=function(){var b={categoryDelete:function(b,f){c.ajaxPost("categoryDelete",{categoryId:b},function(c){c.err||(a('select[name="category'+f+'"] option[value="'+b+'"]').remove(),a('select[name="category'+f+'"]').change())})},
categoryEdit:function(b,f,d){var e={categoryId:b,categoryName:a.trim(f)};c.isEmpty(f)?alert(wpProQuizLocalize.category_no_name):c.ajaxPost("categoryEdit",e,function(c){c.err||(a('select[name="category'+d+'"] option[value="'+b+'"]').text(e.categoryName),a('select[name="category'+d+'"]').change())})},changeTimeFormat:function(b,c){"0"!=c.val()&&a('input[name="'+b+'"]').val(c.val())},templateDelete:function(b,f){c.ajaxPost("templateDelete",{templateId:b,type:f},function(c){c.err||(f?(a('select[name="templateQuestion"] option[value="'+
b+'"]').remove(),a('select[name="templateQuestion"]').change()):(a('select[name="templateQuiz"] option[value="'+b+'"]').remove(),a('select[name="templateQuiz"]').change()))})},templateEdit:function(b,f,d){if(c.isEmpty(f))alert(wpProQuizLocalize.category_no_name);else{var e={templateId:b,name:a.trim(f),type:d};c.ajaxPost("templateEdit",e,function(c){c.err||(d?(a('select[name="templateQuestion"] option[value="'+b+'"]').text(e.name),a('select[name="templateQuestion"]').change()):(a('select[name="templateQuiz"] option[value="'+
b+'"]').text(e.name),a('select[name="templateQuiz"]').change()))})}}};(function(){a('select[name="category"]').change(function(){a('input[name="categoryEditText"]').val(a(this).find(":selected").text())}).change();a('input[name="categoryDelete"]').click(function(){var c=a('select[name="category"] option:selected').val();b.categoryDelete(c,"")});a('input[name="categoryEdit"]').click(function(){var c=a('select[name="category"] option:selected').val(),d=a('input[name="categoryEditText"]').val();b.categoryEdit(c,
d,"")});a('select[name="categoryQuiz"]').change(function(){a('input[name="categoryQuizEditText"]').val(a(this).find(":selected").text())}).change();a('input[name="categoryQuizDelete"]').click(function(){var c=a('select[name="categoryQuiz"] option:selected').val();b.categoryDelete(c,"Quiz")});a('input[name="categoryQuizEdit"]').click(function(){var c=a('select[name="categoryQuiz"] option:selected').val(),d=a('input[name="categoryQuizEditText"]').val();b.categoryEdit(c,d,"Quiz")});a("#statistic_time_format_select").change(function(){b.changeTimeFormat("statisticTimeFormat",
a(this))});a(document).bind("changeTab",function(b){a("#problemInfo").hide("fast");switch(b.tabId){case "#problemContent":a("#problemInfo").show("fast")}});a('input[name="email[html]"]').change(function(){if(void 0==switchEditors)return!1;this.checked?switchEditors.go("adminEmailEditor","tmce"):switchEditors.go("adminEmailEditor","html")}).change();a('input[name="userEmail[html]"]').change(function(){if(void 0==switchEditors)return!1;this.checked?switchEditors.go("userEmailEditor","tmce"):switchEditors.go("userEmailEditor",
"html")}).change();a('select[name="templateQuiz"]').change(function(){a('input[name="templateQuizEditText"]').val(a(this).find(":selected").text())}).change();a('select[name="templateQuestion"]').change(function(){a('input[name="templateQuestionEditText"]').val(a(this).find(":selected").text())}).change();a('input[name="templateQuizDelete"]').click(function(){var c=a('select[name="templateQuiz"] option:selected').val();b.templateDelete(c,0)});a('input[name="templateQuestionDelete"]').click(function(){var c=
a('select[name="templateQuestion"] option:selected').val();b.templateDelete(c,1)});a('input[name="templateQuizEdit"]').click(function(){var c=a('select[name="templateQuiz"] option:selected').val(),d=a('input[name="templateQuizEditText"]').val();b.templateEdit(c,d,0)});a('input[name="templateQuestionEdit"]').click(function(){var c=a('select[name="templateQuestion"] option:selected').val(),d=a('input[name="templateQuestionEditText"]').val();b.templateEdit(c,d,1)})})()},b=function(){var b=this,d=a.noop(),
e=a(".answer_felder > div"),g=a('input[name="answerPointsActivated"]'),r=a('input[name="points"]'),b={generateArrayIndex:function(){var b=a('input[name="answerType"]:checked').val(),b="single"==b||"multiple"==b?"classic_answer":b;a(".answerList").each(function(){var c=a(this).parent().attr("class");a(this).children().each(function(d,f){a(this).find('[name^="answerData"]').each(function(){var a=this.name,f=a.search(/\](\[\w+\])+$/),e=b==c?d:"none";0<f&&(this.name="answerData["+e+a.substring(f,a.length))})})})},
globalValidate:function(){if(c.isEmpty(c.getMceContent("question")))return alert(wpProQuizLocalize.no_question_msg),!1;if(!g.is(":checked")){var b=r.val();if(!c.isNumber(b)||1>b)return alert(wpProQuizLocalize.no_nummber_points),!1}else if("free_answer"==a('input[name="answerType"]:checked').val())return alert(wpProQuizLocalize.dif_points),!1;return!1===d()?!1:!0},answerRemove:function(){var b=a(this).parent();if(2>b.parent().children().length)return!1;b.remove();return!1},addCategory:function(){var b=
a.trim(a('input[name="categoryAdd"]').val());c.isEmpty(b)||c.ajaxPost("categoryAdd",{categoryName:b},function(b){b.err?a("#categoryMsgBox").text(b.err).show("fast").delay(2E3).hide("fast"):(b=a(document.createElement("option")).val(b.categoryId).text(b.categoryName).attr("selected","selected"),a('select[name="category"]').append(b).change())})},addMediaClick:function(){if("function"!=typeof tb_show)return!1;var b=a(this).closest("li"),c=b.find('input[name="answerData[][html]"]:eq(0)'),f=b.find(".wpProQuiz_text:eq(0)");
window.org_send_to_editor=window.send_to_editor;var d=tb_remove;window.send_to_editor=function(b){b=a("img",b)[0].outerHTML;f.val(f.val()+b);c.attr("checked",!0);tb_remove();window.send_to_editor=window.org_send_to_editor};window.tb_remove=function(){window.send_to_editor=window.org_send_to_editor;tb_remove=d;tb_remove()};tb_show("","media-upload.php?type=image&TB_iframe=true")}},h={classic_answer:function(){var b=0,f=0,d=0;a(".classic_answer .answerList").children().each(function(){var e=a(this);
c.isEmpty(e.find('textarea[name="answerData[][answer]"]').val())||(b++,e.find('input[name="answerData[][correct]"]:checked').length&&f++,e=e.find('input[name="answerData[][points]"]').val(),c.isNumber(e)&&0<=e&&d++)});return b?f||a('input[name="disableCorrect"]').is(":checked")&&a('input[name="answerPointsDiffModusActivated"]').is(":checked")&&a('input[name="answerPointsActivated"]').is(":checked")&&"single"==a('input[name="answerType"]:checked').val()?d!=b&&g.is(":checked")?(alert(wpProQuizLocalize.no_nummber_points_new),
!1):!0:(alert(wpProQuizLocalize.no_correct_msg),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},free_answer:function(){return c.isEmpty(a('.free_answer textarea[name="answerData[][answer]"]').val())?(alert(wpProQuizLocalize.no_answer_msg),!1):!0},cloze_answer:function(){return c.isEmpty(c.getMceContent("cloze"))?(alert(wpProQuizLocalize.no_answer_msg),!1):!0},sort_answer:function(){var b=0,f=0;a(".sort_answer .answerList").children().each(function(){var d=a(this);c.isEmpty(d.find('textarea[name="answerData[][answer]"]').val())||
(b++,d=d.find('input[name="answerData[][points]"]').val(),c.isNumber(d)&&0<=d&&f++)});return b?f!=b&&g.is(":checked")?(alert(wpProQuizLocalize.no_nummber_points_new),!1):!0:(alert(wpProQuizLocalize.no_answer_msg),!1)},matrix_sort_answer:function(){var b=0,d=0,f=!0,e=0;a(".matrix_sort_answer .answerList").children().each(function(){var g=a(this),l=g.find('input[name="answerData[][points]"]').val();c.isEmpty(g.find('textarea[name="answerData[][answer]"]').val())?c.isEmpty(g.find('textarea[name="answerData[][sort_string]"]').val())||
(e++,c.isNumber(l)&&0<=l&&d++):(b++,e++,c.isEmpty(g.find('textarea[name="answerData[][sort_string]"]').val())&&(f=!1),c.isNumber(l)&&0<=l&&d++)});return b?f?d!=e&&g.is(":checked")?(alert(wpProQuizLocalize.no_nummber_points_new),!1):!0:(alert(wpProQuizLocalize.no_sort_element_criterion),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},assessment_answer:function(){return c.isEmpty(c.getMceContent("assessment"))?(alert(wpProQuizLocalize.no_answer_msg),!1):!0}};e.hide();(function(){a("#wpProQuiz_tip").change(function(){c.displayChecked(this,
a("#wpProQuiz_tipBox"))}).change();a("#wpProQuiz_correctSameText").change(function(){c.displayChecked(this,a("#wpProQuiz_incorrectMassageBox"),!0)}).change();a('input[name="answerType"]').click(function(){e.hide();var b=this.value;"single"==b?(a("#singleChoiceOptions").show(),a('input[name="disableCorrect"]').change()):(a("#singleChoiceOptions").hide(),a(".classic_answer .wpProQuiz_classCorrect").parent().parent().show());if("single"==b||"multiple"==b){var c="single"==b?"radio":"checkbox",b="classic_answer";
a(".wpProQuiz_classCorrect").each(function(){a("<input type="+c+" />").attr({name:this.name,value:this.value,checked:this.checked}).addClass("wpProQuiz_classCorrect wpProQuiz_checkbox").insertBefore(this)}).remove()}d=void 0!=h[b]?h[b]:a.noop();a("."+b).show()});a('input[name="answerType"]:checked').click();a(".deleteAnswer").click(b.answerRemove);a(".addAnswer").click(function(){var c=a(this).siblings("ul"),d=c.find("li:eq(0)").clone();d.find(".wpProQuiz_checkbox").removeAttr("checked");d.find(".wpProQuiz_text").val("");
d.find(".wpProQuiz_points").val(1);d.find(".deleteAnswer").click(b.answerRemove);d.find(".addMedia").click(b.addMediaClick);d.appendTo(c);return!1});a(".sort_answer ul, .classic_answer ul, .matrix_sort_answer ul").sortable({handle:".wpProQuiz_move"});a("#saveQuestion").click(function(){if(!b.globalValidate())return!1;b.generateArrayIndex();return!0});a(g).change(function(){c.displayChecked(this,a(".wpProQuiz_answerPoints"));c.displayChecked(this,a("#wpProQuiz_showPointsBox"));c.displayChecked(this,
r,!1,!0);c.displayChecked(this,a('input[name="answerPointsDiffModusActivated"]'),!0,!0);this.checked?(a('input[name="answerPointsDiffModusActivated"]').change(),a('input[name="disableCorrect"]').change()):(a(".classic_answer .wpProQuiz_classCorrect").parent().parent().show(),a('input[name="disableCorrect"]').attr("disabled","disabled"))}).change();a('select[name="category"]').change(function(){var b=a(this),c=a("#categoryAddBox").hide();"-1"==b.val()&&c.show()}).change();a("#categoryAddBtn").click(function(){b.addCategory()});
a(".addMedia").click(b.addMediaClick);a('input[name="answerPointsDiffModusActivated"]').change(function(){c.displayChecked(this,a('input[name="disableCorrect"]'),!0,!0);this.checked?a('input[name="disableCorrect"]').change():a(".classic_answer .wpProQuiz_classCorrect").parent().parent().show()}).change();a('input[name="disableCorrect"]').change(function(){c.displayChecked(this,a(".classic_answer .wpProQuiz_classCorrect").parent().parent(),!0)}).change();a("#clickPointDia").click(function(){a(".pointDia").toggle("fast");
return!1});a('input[name="template"]').click(function(d){if("0"==a('select[name="templateSaveList"]').val()&&c.isEmpty(a('input[name="templateName"]').val()))return alert(wpProQuizLocalize.temploate_no_name),d.preventDefault(),!1;b.generateArrayIndex()});a('select[name="templateSaveList"]').change(function(){var b=a('input[name="templateName"]');"0"==a(this).val()?b.show():b.hide()}).change()})()},h=function(){var b=this,d=a("#quizId").val(),e="users",g=a("#wpProQuiz_currentPage"),h=a("#wpProQuiz_pageLeft"),
m=a("#wpProQuiz_pageRight"),k=a("#testSelect"),b={loadStatistic:function(a,b){c.ajaxPost("statisticLoad",{userId:a},function(a){})},loadUsersStatistic:function(){var e={userId:a("#userSelect").val(),quizId:d,testId:a("#testSelect").val()};b.toggleLoadBox(!1);c.ajaxPost("statisticLoad",e,function(c){a.each(c.question,function(){var c=a("#wpProQuiz_tr_"+this.questionId);b.setStatisticData(c,this)});a.each(c.category,function(c,d){var e=a("#wpProQuiz_ctr_"+c);b.setStatisticData(e,d)});a("#testSelect option:gt(0)").remove();
var d=a("#testSelect");a.each(c.tests,function(){var b=a(document.createElement("option"));b.val(this.id);b.text(this.date);c.testId==this.id&&b.attr("selected",!0);d.append(b)});b.parseFormData(c.formData);b.toggleLoadBox(!0)})},loadUsersStatistic_:function(e,t){var g={userId:e,quizId:d,testId:t};b.toggleLoadBox(!1);c.ajaxPost("statisticLoad",g,function(c){a.each(c.question,function(){var c=a("#wpProQuiz_tr_"+this.questionId);b.setStatisticData(c,this)});a.each(c.category,function(c,d){var e=a("#wpProQuiz_ctr_"+
c);b.setStatisticData(e,d)});a("#testSelect option:gt(0)").remove();var d=a("#testSelect");a.each(c.tests,function(){var b=a(document.createElement("option"));b.val(this.id);b.text(this.date);c.testId==this.id&&b.attr("selected",!0);d.append(b)});b.parseFormData(c.formData);a("#userSelect").val(e);a("#testSelect").val(t);b.toggleLoadBox(!0)})},parseFormData:function(b){var c=a("#wpProQuiz_form_box");null==b?c.hide():(a.each(b,function(b,c){a("#form_id_"+b).text(c)}),c.show())},setStatisticData:function(a,
b){a.find(".wpProQuiz_cCorrect").text(b.correct);a.find(".wpProQuiz_cIncorrect").text(b.incorrect);a.find(".wpProQuiz_cTip").text(b.hint);a.find(".wpProQuiz_cPoints").text(b.points);a.find(".wpProQuiz_cResult").text(b.result);a.find(".wpProQuiz_cTime").text(b.questionTime);a.find(".wpProQuiz_cCreateTime").text(b.date)},toggleLoadBox:function(b){var c=a("#wpProQuiz_loadData"),d=a("#wpProQuiz_content");b?(c.hide(),d.show()):(d.hide(),c.show())},reset:function(e){var g=a("#userSelect").val();confirm(wpProQuizLocalize.reset_statistics_msg)&&
(e={quizId:d,userId:g,testId:k.val(),type:e},b.toggleLoadBox(!1),c.ajaxPost("statisticReset",e,function(){b.loadUsersStatistic()}))},loadStatisticOverview:function(e){e={quizId:d,pageLimit:a("#wpProQuiz_pageLimit").val(),onlyCompleted:Number(a("#wpProQuiz_onlyCompleted").is(":checked")),page:g.val(),nav:Number(e)};b.toggleLoadBox(!1);c.ajaxPost("statisticLoadOverview",e,function(c){var d=a("#wpProQuiz_statistics_overview_data"),e=d.children(),g=e.first().clone();e.slice(1).remove();a.each(c.items,
function(){var c=g.clone();b.setStatisticData(c,this);c.find("a").text(this.userName).data("userId",this.userId).click(function(){a("#userSelect").val(a(this).data("userId"));a("#wpProQuiz_typeUser").click();return!1});c.show().appendTo(d)});g.remove();b.toggleLoadBox(!0);void 0!=c.page&&b.handleNav(c.page)})},handleNav:function(c){for(var d=a("#wpProQuiz_currentPage").empty(),e=1;e<=c;e++)a(document.createElement("option")).val(e).text(e).appendTo(d);b.checkNavBar()},checkNavBar:function(){var a=
g.val();1==a?h.hide():h.show();a==g.children().length?m.hide():m.show()},refresh:function(){"users"==e?b.loadUsersStatistic():"formOverview"==e?b.loadFormsOverview(!0):b.loadStatisticOverview(!0)},loadFormsOverview:function(e){e={quizId:d,pageLimit:a("#wpProQuiz_fromPageLimit").val(),onlyUser:a("#wpProQuiz_formUser").val(),page:a("#wpProQuiz_formCurrentPage").val(),nav:Number(e)};b.toggleLoadBox(!1);c.ajaxPost("statisticLoadFormOverview",e,function(c){var d=a("#wpProQuiz_statistics_form_data"),e=
d.children(),g=e.first().clone();e.slice(1).remove();a.each(c.items,function(){var c=g.clone();b.setStatisticData(c,this);c.find("a").text(this.userName).data("userId",this.userId).data("testId",this.testId).click(function(){b.switchTabOnLoad("users");b.loadUsersStatistic_(a(this).data("userId"),a(this).data("testId"));return!1});c.show().appendTo(d)});g.remove();b.toggleLoadBox(!0);void 0!=c.page&&b.handleFormNav(c.page)})},handleFormNav:function(c){for(var d=a("#wpProQuiz_formCurrentPage").empty(),
e=1;e<=c;e++)a(document.createElement("option")).val(e).text(e).appendTo(d);b.checkFormNavBar()},checkFormNavBar:function(){var b=a("#wpProQuiz_formCurrentPage").val();1==b?a("#wpProQuiz_formPageLeft").hide():a("#wpProQuiz_formPageLeft").show();b==a("#wpProQuiz_formCurrentPage").children().length?a("#wpProQuiz_formPageRight").hide():a("#wpProQuiz_formPageRight").show()},switchTabOnLoad:function(b){a(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary");a(".wpProQuiz_tabContent").hide();
var c=a("#wpProQuiz_typeOverview");"users"==b?(e="users",a("#wpProQuiz_tabUsers").show(),c=a("#wpProQuiz_typeUser")):"formOverview"==b?(e="formOverview",a("#wpProQuiz_tabFormOverview").show(),c=a("#wpProQuiz_typeForm")):(e="overview",a("#wpProQuiz_tabOverview").show());c.removeClass("button-secondary").addClass("button-primary")}};(function(){a("#userSelect, #testSelect").change(function(){b.loadUsersStatistic()});a(".wpProQuiz_update").click(function(){b.refresh()});a("#wpProQuiz_reset").click(function(){b.reset(0)});
a("#wpProQuiz_resetUser").click(function(){b.reset(1)});a(".wpProQuiz_resetComplete").click(function(){b.reset(2)});a(".wpProQuiz_tab").click(function(){var c=a(this);a(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary");c.removeClass("button-secondary").addClass("button-primary");a(".wpProQuiz_tabContent").hide();"wpProQuiz_typeUser"==c.attr("id")?(e="users",a("#wpProQuiz_tabUsers").show(),b.loadUsersStatistic()):"wpProQuiz_typeForm"==c.attr("id")?(e="formOverview",a("#wpProQuiz_tabFormOverview").show(),
b.loadFormsOverview(!0)):(e="overview",a("#wpProQuiz_tabOverview").show(),b.loadStatisticOverview(!0));return!1});a("#wpProQuiz_onlyCompleted").change(function(){g.val(1);b.loadStatisticOverview(!0)});a("#wpProQuiz_pageLimit").change(function(){g.val(1);b.loadStatisticOverview(!0)});h.click(function(){g.val(Number(g.val())-1);b.loadStatisticOverview(!1);b.checkNavBar()});m.click(function(){g.val(Number(g.val())+1);b.loadStatisticOverview(!1);b.checkNavBar()});g.change(function(){b.loadStatisticOverview(!1);
b.checkNavBar()});a("#wpProQuiz_formUser, #wpProQuiz_fromPageLimit").change(function(){a("#wpProQuiz_formCurrentPage").val(1);b.loadFormsOverview(!0)});a("#wpProQuiz_formPageLeft").click(function(){a("#wpProQuiz_formCurrentPage").val(Number(g.val())-1);b.loadFormsOverview(!1);b.checkFormNavBar()});a("#wpProQuiz_formPageRight").click(function(){a("#wpProQuiz_formCurrentPage").val(Number(g.val())+1);b.loadFormsOverview(!1);b.checkFormNavBar()});a("#wpProQuiz_formCurrentPage").change(function(){b.loadFormsOverview(!1);
b.checkFormNavBar()});b.loadUsersStatistic()})()},n=function(){var b=a("#quizId").val(),d=null,e=null,g={data:{quizId:b,users:-1,pageLimit:100,dateFrom:0,dateTo:0,generateNav:0},changeFilter:function(){var b=function(a){a=a.datepicker("getDate");return null===a?0:a.getTime()/1E3};a.extend(this.data,{users:a("#wpProQuiz_historyUser").val(),pageLimit:a("#wpProQuiz_historyPageLimit").val(),dateFrom:b(a("#datepickerFrom")),dateTo:b(a("#datepickerTo")),generateNav:1});return this.data}},h={data:{pageLimit:100,
onlyCompleted:0,generateNav:0,quizId:b},changeFilter:function(){a.extend(this.data,{pageLimit:a("#wpProQuiz_overviewPageLimit").val(),onlyCompleted:Number(a("#wpProQuiz_overviewOnlyCompleted").is(":checked")),generateNav:1})}},m={deleteUserStatistic:function(d,e){if(!confirm(wpProQuizLocalize.reset_statistics_msg))return!1;c.ajaxPost("statisticResetNew",{refId:d,userId:e,quizId:b,type:0},function(){a("#wpProQuiz_user_overlay").hide();g.changeFilter();k.loadHistoryAjax();h.changeFilter();k.loadOverviewAjax()})},
deleteAll:function(){if(!confirm(wpProQuizLocalize.reset_statistics_msg))return!1;c.ajaxPost("statisticResetNew",{quizId:b,type:1},function(){g.changeFilter();k.loadHistoryAjax();h.changeFilter();k.loadOverviewAjax()})}},k={loadHistoryAjax:function(){var b=a.extend({page:g.data.generateNav?1:d.getCurrentPage()},g.data);k.loadBox(!0);var e=a("#wpProQuiz_historyLoadContext").hide();c.ajaxPost("statisticLoadHistory",b,function(b){e.html(b.html).show();b.navi&&d.setNumPage(b.navi);g.data.generateNav=
0;e.find(".user_statistic").click(function(){k.loadUserAjax(0,a(this).data("ref_id"),!1);return!1});e.find(".wpProQuiz_delete").click(function(){m.deleteUserStatistic(a(this).parents("tr").find(".user_statistic").data("ref_id"),0);return!1});k.loadBox(!1)})},loadUserAjax:function(d,e,g){a("#wpProQuiz_user_overlay, #wpProQuiz_loadUserData").show();var h=a("#wpProQuiz_user_content").hide();c.ajaxPost("statisticLoadUser",{quizId:b,userId:d,refId:e,avg:Number(g)},function(b){h.html(b.html);h.find(".wpProQuiz_update").click(function(){k.loadUserAjax(d,
e,g);return!1});h.find("#wpProQuiz_resetUserStatistic").click(function(){m.deleteUserStatistic(e,d)});h.find(".statistic_data").click(function(){a(this).parents("tr").next().toggle("fast");return!1});a("#wpProQuiz_loadUserData").hide();h.show()})},loadBox:function(b,c){b?a("#wpProQuiz_loadDataHistory").show():a("#wpProQuiz_loadDataHistory").hide()},loadOverviewAjax:function(){var b=a.extend({page:h.data.generateNav?1:e.getCurrentPage()},h.data);a("#wpProQuiz_loadDataOverview").show();var d=a("#wpProQuiz_overviewLoadContext").hide();
c.ajaxPost("statisticLoadOverviewNew",b,function(b){d.html(b.html).show();b.navi&&e.setNumPage(b.navi);h.data.generateNav=0;d.find(".user_statistic").click(function(){k.loadUserAjax(a(this).data("user_id"),0,!0);return!1});d.find(".wpProQuiz_delete").click(function(){m.deleteUserStatistic(0,a(this).parents("tr").find(".user_statistic").data("user_id"));return!1});a("#wpProQuiz_loadDataOverview").hide()})}};(function(){d=new q(a("#historyNavigation"),{onChange:function(){k.loadHistoryAjax()}});e=new q(a("#overviewNavigation"),
{onChange:function(){k.loadOverviewAjax()}});a("#datepickerFrom").datepicker({closeText:wpProQuizLocalize.closeText,currentText:wpProQuizLocalize.currentText,monthNames:wpProQuizLocalize.monthNames,monthNamesShort:wpProQuizLocalize.monthNamesShort,dayNames:wpProQuizLocalize.dayNames,dayNamesShort:wpProQuizLocalize.dayNamesShort,dayNamesMin:wpProQuizLocalize.dayNamesMin,dateFormat:wpProQuizLocalize.dateFormat,firstDay:wpProQuizLocalize.firstDay,changeMonth:!0,onClose:function(b){a("#datepickerTo").datepicker("option",
"minDate",b)}});a("#datepickerTo").datepicker({closeText:wpProQuizLocalize.closeText,currentText:wpProQuizLocalize.currentText,monthNames:wpProQuizLocalize.monthNames,monthNamesShort:wpProQuizLocalize.monthNamesShort,dayNames:wpProQuizLocalize.dayNames,dayNamesShort:wpProQuizLocalize.dayNamesShort,dayNamesMin:wpProQuizLocalize.dayNamesMin,dateFormat:wpProQuizLocalize.dateFormat,firstDay:wpProQuizLocalize.firstDay,changeMonth:!0,onClose:function(b){a("#datepickerFrom").datepicker("option","maxDate",
b)}});a("#filter").click(function(){g.changeFilter();k.loadHistoryAjax()});a("#wpProQuiz_overlay_close").click(function(){a("#wpProQuiz_user_overlay").hide()});a("#wpProQuiz_tabHistory .wpProQuiz_update").click(function(){g.changeFilter();k.loadHistoryAjax();return!1});a("#wpProQuiz_tabOverview .wpProQuiz_update").click(function(){h.changeFilter();k.loadOverviewAjax();return!1});a(".wpProQuiz_resetComplete").click(function(){m.deleteAll();return!1});a("#overviewFilter").click(function(){h.changeFilter();
k.loadOverviewAjax()});g.changeFilter();k.loadHistoryAjax();h.changeFilter();k.loadOverviewAjax()})()};(function(){e();var c=a.noop;a(".wpProQuiz_questionEdit").length?c=b:a(".wpProQuiz_globalSettings").length?c=d:a(".wpProQuiz_statistics").length?c=h:a(".wpProQuiz_statisticsNew").length&&(c=n);c();a(".wpProQuiz_demoImgBox a").mouseover(function(b){var c=a(this),d=a(document).width(),c=c.siblings().outerWidth(!0);b.pageX+c>d&&(b=d-(b.pageX+c+30),a(this).next().css("left",b+"px"));a(this).next().show()}).mouseout(function(){a(this).next().hide()}).click(function(){return!1})})()})()});
